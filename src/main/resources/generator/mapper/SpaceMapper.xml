<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.csh.mypicturebackend.mapper.SpaceMapper">

    <resultMap id="BaseResultMap" type="com.csh.mypicturebackend.model.entity.Space">
            <id property="id" column="id" />
            <result property="spaceName" column="spaceName" />
            <result property="spaceLevel" column="spaceLevel" />
            <result property="maxSize" column="maxSize" />
            <result property="maxCount" column="maxCount" />
            <result property="totalSize" column="totalSize" />
            <result property="totalCount" column="totalCount" />
            <result property="userId" column="userId" />
            <result property="createTime" column="createTime" />
            <result property="editTime" column="editTime" />
            <result property="updateTime" column="updateTime" />
            <result property="isDelete" column="isDelete" />
            <result property="spaceType" column="spaceType" />
    </resultMap>

    <sql id="Base_Column_List">
        id,spaceName,spaceLevel,maxSize,maxCount,totalSize,
        totalCount,userId,createTime,editTime,updateTime,
        isDelete,spaceType
    </sql>

<!--    自定义SQL  -->
    <!-- 获取存储使用量排名前 N 的空间 -->
    <select id="getTopNSpaceUsage" resultMap="BaseResultMap">
        SELECT <include refid="Base_Column_List"/>
        FROM space
        ORDER BY totalSize DESC
        LIMIT #{topN}
    </select>

    <!-- 删除某用户的所有空间 -->
    <delete id="deleteByUserId">
        DELETE FROM space WHERE userId = #{userId}
    </delete>

</mapper>
